// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

// Event type enumeration for type-safe metrics tracking
// Reference: docs/cloudflare-analytics-plan.md
enum EventType {
  visit
  book_now_clicked
  phone_clicked
  email_clicked
  social_media_clicked
  product_referral_clicked
  blog_post_clicked
  external_link_clicked
  ai_bot_visit  // AI bot traffic detection (GPTBot, ClaudeBot, etc.)
}

// Metrics tracking model
model MetricsEvent {
  id        String    @id @default(uuid())
  createdAt DateTime  @default(now()) @map("created_at")
  eventType EventType @map("event_type")
  url       String    // Full URL
  pathname  String    // Just the path for easier querying
  userAgent String?   @map("user_agent")
  referrer  String?
  eventData Json?     @map("event_data") // For click targets, additional metadata

  @@index([eventType])
  @@index([pathname])
  @@index([createdAt])
  @@map("metrics_events")
}
